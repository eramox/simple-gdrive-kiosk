INFO:__main__:Using the version file https://drive.google.com/file/d/1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC/view?usp=share_link
DEBUG:drive_file_downloader:uid='1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC'
DEBUG:drive_file_downloader:exp_link='https://drive.google.com/file/d/1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC/export/pptx'
INFO:kiosk_service:Startign main loop
INFO:kiosk_service:Checking if version file https://drive.google.com/file/d/1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC/view?usp=share_link changed
DEBUG:drive_file_downloader:Downloading 1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC to tmp_file.doc
DEBUG:drive_file_downloader:-----------START-----------
GET https://drive.google.com/uc?export=download&id=1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC


None
------------END------------
DEBUG:drive_file_downloader:response.headers={'X-GUploader-UploadID': 'ADPycdu0nS8ikmg0TdPb5NZGoSmAsuO_iGNlfu-zIRRZMJsfTE3Vk56_5FpM8HyW2lt4PYeSlwpUZuNqfRiz4veGEcmkYg', 'Content-Type': 'application/vnd.oasis.opendocument.text', 'Content-Disposition': 'attachment; filename="lien_presentation_a_afficher.odt"; filename*=UTF-8\'\'lien_presentation_a_afficher.odt', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Credentials': 'false', 'Access-Control-Allow-Headers': 'Accept, Accept-Language, Authorization, Cache-Control, Content-Disposition, Content-Encoding, Content-Language, Content-Length, Content-MD5, Content-Range, Content-Type, Date, developer-token, financial-institution-id, X-Goog-Sn-Metadata, X-Goog-Sn-PatientId, GData-Version, google-cloud-resource-prefix, linked-customer-id, login-customer-id, x-goog-request-params, Host, If-Match, If-Modified-Since, If-None-Match, If-Unmodified-Since, Origin, OriginToken, Pragma, Range, request-id, Slug, Transfer-Encoding, hotrod-board-name, hotrod-chrome-cpu-model, hotrod-chrome-processors, Want-Digest, X-Ad-Manager-Impersonation, x-chrome-connected, X-ClientDetails, X-Client-Version, X-Firebase-Locale, X-Goog-Firebase-Installations-Auth, X-Firebase-Client, X-Firebase-Client-Log-Type, X-Firebase-GMPID, X-Firebase-Auth-Token, X-Firebase-AppCheck, X-Firebase-Token, X-Goog-Drive-Client-Version, X-Goog-Drive-Resource-Keys, X-GData-Client, X-GData-Key, X-GoogApps-Allowed-Domains, X-Goog-AdX-Buyer-Impersonation, X-Goog-Api-Client, X-Goog-Visibilities, X-Goog-AuthUser, x-goog-ext-124712974-jspb, x-goog-ext-467253834-jspb, x-goog-ext-251363160-jspb, x-goog-ext-259736195-jspb, x-goog-ext-477772811-jspb, X-Goog-PageId, X-Goog-Encode-Response-If-Executable, X-Goog-Correlation-Id, X-Goog-Request-Info, X-Goog-Request-Reason, X-Goog-Experiments, x-goog-iam-authority-selector, x-goog-iam-authorization-token, X-Goog-Spatula, X-Goog-Travel-Bgr, X-Goog-Travel-Settings, X-Goog-Upload-Command, X-Goog-Upload-Content-Disposition, X-Goog-Upload-Content-Length, X-Goog-Upload-Content-Type, X-Goog-Upload-File-Name, X-Goog-Upload-Header-Content-Encoding, X-Goog-Upload-Header-Content-Length, X-Goog-Upload-Header-Content-Type, X-Goog-Upload-Header-Transfer-Encoding, X-Goog-Upload-Offset, X-Goog-Upload-Protocol, x-goog-user-project, X-Goog-Visitor-Id, X-Goog-FieldMask, X-Google-Project-Override, X-Goog-Api-Key, X-HTTP-Method-Override, X-JavaScript-User-Agent, X-Pan-Versionid, X-Proxied-User-IP, X-Origin, X-Referer, X-Requested-With, X-Stadia-Client-Context, X-Upload-Content-Length, X-Upload-Content-Type, X-Use-Alt-Service, X-Use-HTTP-Status-Code-Override, X-Ios-Bundle-Identifier, X-Android-Package, X-Ariane-Xsrf-Token, X-YouTube-VVT, X-YouTube-Page-CL, X-YouTube-Page-Timestamp, X-Compass-Routing-Destination, x-framework-xsrf-token, X-Goog-Meeting-ABR, X-Goog-Meeting-Botguardid, X-Goog-Meeting-ClientInfo, X-Goog-Meeting-ClientVersion, X-Goog-Meeting-Debugid, X-Goog-Meeting-Identifier, X-Goog-Meeting-Interop-Cohorts, X-Goog-Meeting-Interop-Type, X-Goog-Meeting-RtcClient, X-Goog-Meeting-StartSource, X-Goog-Meeting-Token, X-Goog-Meeting-ViewerInfo, X-Goog-Meeting-Viewer-Token, X-Client-Data, x-sdm-id-token, X-Sfdc-Authorization, MIME-Version, Content-Transfer-Encoding, X-Earth-Engine-App-ID-Token, X-Earth-Engine-Computation-Profile, X-Earth-Engine-Computation-Profiling, X-Play-Console-Experiments-Override, X-Play-Console-Session-Id, x-alkali-account-key, x-alkali-application-key, x-alkali-auth-apps-namespace, x-alkali-auth-entities-namespace, x-alkali-auth-entity, x-alkali-client-locale, EES-S7E-MODE, cast-device-capabilities, X-Server-Timeout, x-foyer-client-environment, x-goog-greenenergyuserappservice-metadata, x-goog-sherlog-context, X-Server-Token', 'Access-Control-Allow-Methods': 'GET,HEAD,OPTIONS', 'Content-Length': '12198', 'Date': 'Sat, 11 Mar 2023 12:42:56 GMT', 'Expires': 'Sat, 11 Mar 2023 12:42:56 GMT', 'Cache-Control': 'private, max-age=0', 'X-Goog-Hash': 'crc32c=ZTwy9A==', 'Server': 'UploadServer', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}
DEBUG:drive_file_downloader:response.json=<bound method Response.json of <Response [200]>>
DEBUG:drive_file_downloader:response.cookies=<RequestsCookieJar[]>
DEBUG:drive_file_downloader:response.status_code=200 type(response.status_code)=<class 'int'>
DEBUG:drive_file_downloader:Saving to tmp_file.doc
DEBUG:kiosk_service:Processing libreoffice file tmp_file.doc
[90m/home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/main.py Line: 15[0m
[90m  /home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/kiosk_service.py Line: 35[0m
[90m    /home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/drive_file_downloader.py Line: 177[0m
[91m      2023-03-11 13:42:55 - GET: <requests.sessions.Session object at 0x7f8647dbeec0> (['https://drive.google.com/uc'], {'params': {'export': 'download', 'id': '1bFwRczb7FqejAEL0qrzR4yAJZ81iVXCC'}}) {}[0m
Traceback (most recent call last):
  File "/home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/main.py", line 23, in <module>
    main(link)
  File "/home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/main.py", line 15, in main
    return KioskService(version_share_link).loop()
  File "/home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/kiosk_service.py", line 38, in loop
    link_presentation = self.get_version_from_librofficedoc(self.VERSION_FILE)
  File "/home/eramox/Documents/workspace/cannes_beach_kiosk/cb_kiosk/kiosk_service.py", line 65, in get_version_from_librofficedoc
    raise ValueError(f"The document has {len(elements)}")
ValueError: The document has 0
